<html>
  <head>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd@2.0.2"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs/dist/tf.min.js"></script>
    <script src="https://docs.opencv.org/3.4.0/opencv.js" type="text/javascript"></script>
    <script src="https://cdn.plot.ly/plotly-2.24.1.min.js" charset="utf-8"></script>
    <!--<script defer src="https://pyscript.net/latest/pyscript.js"></script>-->
    <!--<script type="module" src="vi.js"></script>-->
    <!--<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
      -->
  </head>
  <body>
    <h1 style="text-align: center">Find your bicycles in images, videos and livestreams!</h1>
    <div id="select" style="align-items:center">
        <h2>choose your type of media</h2>
        <button onclick="selectType('image')">image</button>
      </div>
      <button onclick="selectType('home')" id="home" style="display: none">home</button>
      <div id ="imagepredict" style="display: none">
        <img id="myimage" height="180" width="180">
        <input type="file" id="photo" name="photo" accept="image/*" onchange="predictImage(event)">
        <p id="imagePrediction"></p>
      </div>
  
  
        
      </div>
      <script>
        const model =  tf.loadGraphModel('');
        let mobilenet = undefined;
        loadMobileNetFeatureModel();
        predict = true;
        camEnabled=false;
        graphCreated=false;
        predictions=[]
      function selectType(el){
        if (el=="home"){
          document.getElementById("select").style.display="";
          document.getElementById("imagepredict").style.display="none";
          document.getElementById("home").style.display="none";
        }else{
          document.getElementById("select").style.display="none";
          document.getElementById("home").style.display="";
          if (el=="image"){
            document.getElementById("imagepredict").style.display="";
  
          }
        }
      }
      function predictImage(event){
        const image=document.getElementById("photo").files[0]
        image.src = URL.createObjectURL(event.target.files[0])
        var selectedFile = event.target.files[0];
        var reader = new FileReader();
  
        var imgtag = document.getElementById("myimage");
        imgtag.title = selectedFile.name;
        reader.onload = function(event) {
          imgtag.src = event.target.result;
        };
        
        reader.readAsDataURL(selectedFile);
        console.log(selectedFile)
        model.then(function (res) {
      const example = tf.cast(tf.browser.fromPixels(imgtag),'float32');
      const prediction = res.predict(example.reshape([-1,180,180,3])).squeeze();
      console.log("prediction: "+prediction);
      let highestIndex = prediction.argMax().arraySync()
      document.getElementById("imagePrediction").innerText="This image is"+ (highestIndex==0?" ":" not ") + "a bike!"
      console.log(highestIndex)
  }, function (err) {
      console.log(err);
  });
  
      }
        
  
      </script>
      
      <script type="css">
        body {
    font-family: helvetica, arial, sans-serif;
    margin: 2em;
  }
  
  h1 {
    font-style: italic;
    color: #FF6F00;
  }
  
  
  video {
    clear: both;
    display: block;
    margin: 10px;
    background: #000000;
    width: 640px;
    height: 480px;
  }
  
  button {
    padding: 10px;
    float: left;
    margin: 5px 3px 5px 10px;
  }
  
  .removed {
    display: none;
  }
  
  #status {
    font-size:150%;
  }
  div{
    width=100%;
    align-items:'center';
  }
  
      </script>
      
    </body>
</html>